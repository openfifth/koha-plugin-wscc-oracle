# Requirements for for acquisitions CSV output to Oracle

## Interface

| Field                                       | Value                                             |
| ------------------------------------------- | ------------------------------------------------- |
| File Name (& extension)                     | KOHA_SaaS_APInvoice_DDMMYYYYHH24MISS.csv          |
| Delimiter                                   | "\|", Pipe                                        |
| Quotation Character                         | " ", Double Quote                                 |
| Record Terminator                           | "<CR><LF>", Carriage return followed by line feed |
| Average File Size                           | TBD                                               |
| Average Rows per File                       | N/A                                               |
| Maximum File Size                           | 100 (invoice per day)                             |
| Maximum Rows per File                       | N/A                                               |
| Source System Name                          | KOHA                                              |
| Target System Name                          | Oracle Fusion                                     |
| Interface Frequency                         | Daily                                             |
| Transfer Medium                             | Middleware                                        |
| Inbound / Outbound                          | Inbound                                           |
| Accept / Reject Atomic Transaction Criteria | Standard Oracle functionality will determine.     |

## Oracle CSV Fields

### AP_INVOICE_INTERFACE (Header lines)

| Available in Source file | Mapping Sourcing File                    | Comments                                                                                                                                      | Action                                   | Oracle Header Info          | Oracle Sample Data 1                                  |
| ------------------------ | :--------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------- | :-------------------------- | :---------------------------------------------------- |
| NA                       | Generate Sequence                        |                                                                                                                                               | Use Sequence                             | \*Invoice ID                | 100                                                   |
| NA                       | Constant = West Sussex County Council BU |                                                                                                                                               | Use Default                              | \*Business Unit             | West Sussex County Council BU                         |
| NA                       | Constant = KOHA Invoices                 |                                                                                                                                               | Use Default                              | \*Source                    | KOHA                                                  |
| Yes                      | INVOICE_NUMBER                           | Use from Source file                                                                                                                          | Use Source                               | \*Invoice Number            | INV-KOHA-WSCC-1                                       |
| Yes                      | INVOICE_TOTAL                            | Use from Source file                                                                                                                          | Use Source                               | \*Invoice Amount            | 5200                                                  |
| Yes                      | INVOICE_DATE                             | Use from Source file                                                                                                                          | Derive from Source                       | \*Invoice Date              | 2025/3/21 Note: Date format needs to be in YYYY/MM/DD |
| NA                       | Not Available                            | Oracle Supplier Name will be derived from Oracle Supplier Number using unique alternate site name passed as vendor number in the source file. | Derive from alternate supplier site name | \*\*Supplier Name           |                                                       |
| Yes                      | SUPPLIER_NUMBER_PROPERTY_KEY             | Oracle Supplier Number will be derived using unique alternate site name passed as vendor number in the source file.                           | Derive from alternate supplier site name | \*\*Supplier Number         | 3153                                                  |
|                          | Not Available                            | Oracle Supplier Site will be derived using unique alternate site name passed as vendor number in the source file.                             | Derive from alternate supplier site name | \*Supplier Site             |                                                       |
| NA                       | Constant = GBP                           |                                                                                                                                               | Use Default                              | Invoice Currency            | GBP                                                   |
| NA                       | Constant = GBP                           |                                                                                                                                               | Use Default                              | Payment Currency            | GBP                                                   |
| NA                       | Constant = Libraries                     |                                                                                                                                               | Use Default                              | Description                 | Libraries                                             |
| NA                       | File Name                                | Use source file name without extension                                                                                                        | Use Source                               | Import Set                  | APInvoice_DDMMYYYYHH24MISS                            |
| NA                       | Not Available                            | If positive amount, default to STANDARD, else CREDIT                                                                                          | Derivation Logic                         | \*Invoice Type              | STANDARD                                              |
| NA                       | Constant = West Sussex County Council    |                                                                                                                                               | Use Default                              | Legal Entity                | West Sussex County Council                            |
| NA                       |                                          | Default from Supplier site                                                                                                                    | Use Default                              | \*Payment Terms             | Net 30                                                |
| Yes                      | SHIPMENT_DATE                            | Use shipment date as invoice received date.                                                                                                   | Use Source                               | Invoice Received Date       | 2025/3/20 Note: Date format needs to be in YYYY/MM/DD |
| NA                       | Constant = SYSDATE                       |                                                                                                                                               | Use Default                              | Accounting Date             |                                                       |
| NA                       | Not available                            | The payment method will be left blank as it will default from primary payment method at Supplier Site                                         | Leave Blank                              | Payment Method              |                                                       |
| NA                       | Constant = 'N'                           |                                                                                                                                               | Use Default                              | Pay Group                   | N                                                     |
| NA                       | Constant = 'N'                           |                                                                                                                                               | Use Default                              | Pay Alone                   | N                                                     |
| NA                       | Constant = 'N'                           |                                                                                                                                               | Use Default                              | Calculate Tax During Import | N                                                     |
| NA                       | Constant = 'N'                           |                                                                                                                                               | Use Default                              | Add Tax to Invoice Amount   | N                                                     |

### AP_INVOICE_LINES_INTERFACE (Order lines)

| Available in Source File | Mapping to Source File                                                                                            | Comments / Notes                                                                                                                                                                                                                                  | Action               | Oracle Fields                 |
| :----------------------- | :---------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :------------------- | :---------------------------- |
| NA                       | Generate Sequence                                                                                                 | Value same as in Header to link Invoice header with Invoice Lines                                                                                                                                                                                 | Copy from Header     | \*Invoice ID                  |
| NA                       | Sequence                                                                                                          | Reset the sequence to 1 for each Invoice                                                                                                                                                                                                          | Use Sequence         | Line Number                   |
| NA                       | Constant = "ITEM"                                                                                                 |                                                                                                                                                                                                                                                   | Use Default          | \*Line Type                   |
| Yes                      | LINE_AMOUNT                                                                                                       | Use from Source file                                                                                                                                                                                                                              | Use Source           | \*Amount                      |
| Yes                      | DESCRIPTION                                                                                                       | Use from Source file                                                                                                                                                                                                                              | Use Source           | Description                   |
| Yes                      | Cost Centre – COST_CENTRE_PROPERTY_KEY, Objective - OBJECTIVE, Subjective - SUBJECTIVE, SubAnalysis – SUBANALYSIS | Following is representation of Distribution Combination: Company code: 1000[Default] Cost Centre: RN05 Objective: ZZZ999 Subjective - 503000 Sub Analysis – [Depending on type of item required] Spare1 - 000000[Default] Spare2 -000000[Default] | Use Source + Default | Distribution Combination      |
| Yes                      | TAX_CODE                                                                                                          | Use from Source file                                                                                                                                                                                                                              | Use Source           | Tax Classification Code       |
| Yes                      | TAX_AMOUNT                                                                                                        | Use from Source file                                                                                                                                                                                                                              | Use Source           | Tax Control Amount            |
| NA                       | Constant = 'N'                                                                                                    |                                                                                                                                                                                                                                                   | Use Default          | Prorate Across All Item Lines |
| NA                       | Constant = WSCC Library                                                                                           | ANY ADDITIONAL INFORMATION CAN BE STORED USING ATTRIBUTES                                                                                                                                                                                         | Use Default          | Attribute Category            |
| Yes                      | CONTRACT_NUMBER                                                                                                   | Contract Number                                                                                                                                                                                                                                   | Use Source           | ATTRIBUTE1                    |

## Koha Field mappings

## Additional notes

- For accounts payable, for each item purchased we must set Cost Center, Objective, Subjective and SubAnalysis.
  - Cost Center = RN05
  - Objective = ZZZ999
  - Subjective = 503000
  - SubAnalysis depends on the type of item purchased

## Error handling, Archiving and Recovery

Oracle will send emails to the business when parsing errors are encountered.

No specific requirements at the Koha side for archival or audit trail.
